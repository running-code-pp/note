# 概念
- **重入** : 同一个函数被不同的执行流调用，前一个执行流还没执行完，下一个执行流就进入了
- **可重入** : 多个执行流执行一段代码，结果互不影响，每个执行流访问各自的私有栈
- **不可重入** ：多个执行流执行一代码，结果会互相影响
- **可重入函数** ： 当一个执行流因为异常或内核切换而中断转而为另一个执行流时，后者对该函数的调用不会影响前一个执行流对该函数最后的调用结果

<span style="color: pink; text-decoration: underline; font-weight: bold;">可重入函数是线程安全函数，但是反过来，线程安全函数未必是可重入函数。</span>

# 可重入函数的条件
- (1)不使用全局变量或静态变量；
- (2)不使用用malloc或者new开辟出的空间；
- (3)不调用不可重入函数；
- (4)不返回静态或全局数据，所有数据都有函数的调用者提供；
- (5)使用本地数据，或者通过制作全局数据的本地拷贝来保护全局数据；
  
# 不可重入函数的常见特征
- (1)调用了malloc/free函数，因为malloc函数是用全局链表来管理堆的。
- (2)调用了标准I/O库函数，标准I/O库的很多实现都以不可重入的方式使用全局数据结构。
- (3)可重入体内使用了静态的数据结构。

# linux中的可重入函数

| 列1         | 列2         | 列3         | 列4         | 列5         |
|-------------|-------------|-------------|-------------|-------------|
| accept      | fchmod      | lseek       | sendto      | stat        |
| access      | fchown      | lstat       | setgid      | symlink     |
| aio_error   | fcntl       | mkdir       | setpgid     | sysconf     |
| aio_return  | fdatasync   | mkfifo      | setpgrp     | tcdrain     |
| aio_suspend | fork        | open        | setsid      | tcflow      |
| alarm       | fpathconf   | pathconf    | setsockopt  | tcflush     |
| bind        | fstat       | pause       | setuid      | tcgetattr   |
| cfgetispeed | fsync       | pipe        | shutdown    | tcgetpgrp   |
| cfgetospeed | ftruncate   | poll        | sigaction   | tcsendbreak |
| cfsetispeed | getegid     | posix_trace_event | sigaddset | tcsetattr   |
| cfsetospeed | geteuid     | pselect     | sigdelset   | tcsetpgrp   |
| chdir       | getgid      | raise       | sigemptyset | time        |
| chmod       | getgroups   | read        | sigfillset  | timer_getoverrun |
| chown       | getpeername | readlink    | sigismember | timer_gettime |
| clock_gettime | getpgrp    | recv        | sigpause    | timer_settime |
| close       | getpid      | recvfrom    | sigpending  | times       |
| connect     | getppid     | recvmsg     | sigprocmask | uname       |
| creat       | getsockname | rename      | sigqueue    | unlink      |
| dup         | getsockopt  | rmdir       | sigset      | utime       |
| dup2        | geteuid     | select      | sigsuspend  | utimes      |
| execle      | kill        | sem_post    | sleep       | wait        |
| execve      | link        | sem_send    | socket      | waitpid     |
| _Exit & _exit | listen    | sendmsg     | socketpair  | write       |
